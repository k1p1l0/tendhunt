---
phase: 05-vibe-scanner
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/app/(dashboard)/scanners/page.tsx
  - src/components/scanners/scanner-list.tsx
  - src/components/scanners/create-scanner-modal.tsx
  - src/components/scanners/scanner-creation-form.tsx
  - src/components/layout/app-sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "User sees a list of their scanners with name, type, last updated, and status"
    - "User can click '+ Create Scanner' to open a type-selection modal"
    - "User picks a scanner type (RFPs, Board Meetings, Buyers) from type cards"
    - "After picking type, user sees a creation form with AI-generated name, description, and search query"
    - "User can edit all fields before saving and navigating into the scanner"
    - "Sidebar nav shows 'Scanners' instead of 'Vibe Scanner'"
  artifacts:
    - path: "src/app/(dashboard)/scanners/page.tsx"
      provides: "Scanners list page at /scanners"
    - path: "src/components/scanners/scanner-list.tsx"
      provides: "Scanner list component with rows showing name, type badge, dates, actions"
    - path: "src/components/scanners/create-scanner-modal.tsx"
      provides: "Modal with type selection cards (RFPs, Board Meetings, Buyers)"
    - path: "src/components/scanners/scanner-creation-form.tsx"
      provides: "Creation form with name, description, search query textarea, and type-specific filters"
    - path: "src/components/layout/app-sidebar.tsx"
      provides: "Updated sidebar with 'Scanners' nav item replacing 'Vibe Scanner'"
  key_links:
    - from: "src/app/(dashboard)/scanners/page.tsx"
      to: "/api/scanners"
      via: "fetch GET for scanner list, POST for creation"
      pattern: "api/scanners"
    - from: "src/components/scanners/scanner-creation-form.tsx"
      to: "/api/scanners/generate-query"
      via: "fetch POST for AI-generated search query"
      pattern: "api/scanners/generate-query"
    - from: "src/components/scanners/create-scanner-modal.tsx"
      to: "src/components/scanners/scanner-creation-form.tsx"
      via: "Step transition from type selection to creation form"
      pattern: "ScannerCreationForm"
---

<objective>
Build the scanner list page and the full scanner creation flow: type selection modal, AI-generated query, and creation form with editable fields.

Purpose: This is the entry point for the entire scanner experience. Users need to see their scanners, create new ones, and configure them before entering the table view. The creation flow must demonstrate the AI-powered query generation that makes TendHunt unique.

Output: Scanners list page at /scanners, type selection modal, creation form, and updated sidebar navigation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-vibe-scanner/05-CONTEXT.md
@.planning/phases/05-vibe-scanner/05-01-SUMMARY.md

# Key source files
@src/models/scanner.ts                    # Scanner model (from Plan 01)
@src/lib/scanners.ts                      # Scanner CRUD + query generation (from Plan 01)
@src/app/api/scanners/route.ts            # Scanner list + create API (from Plan 01)
@src/app/api/scanners/generate-query/route.ts  # Query generation API (from Plan 01)
@src/components/layout/app-sidebar.tsx     # Sidebar navigation to update
@src/app/(dashboard)/contracts/page.tsx   # Existing page pattern reference
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scanner list page with creation modal and type selection</name>
  <files>src/app/(dashboard)/scanners/page.tsx, src/components/scanners/scanner-list.tsx, src/components/scanners/create-scanner-modal.tsx, src/components/layout/app-sidebar.tsx</files>
  <action>
**1. Create ScannerList component** at `src/components/scanners/scanner-list.tsx`:

Client component ("use client"). Props: `{ scanners: Array<{ _id: string; name: string; type: ScannerType; description?: string; lastScoredAt?: string; createdAt: string; updatedAt: string; aiColumns: Array<{ columnId: string; name: string }> }>; onScannerClick: (id: string) => void; onDeleteScanner: (id: string) => void }`.

Layout (like Getmany's Scan & Bid):
- List of scanner rows, each in a Card or bordered row
- Each row shows:
  - **Scanner name** (font-medium, text-base) -- clickable, navigates to scanner detail
  - **Type badge** (small colored badge: "RFPs" = blue, "Board Meetings" = purple, "Buyers" = green)
  - **Last updated** date (relative time or formatted date, text-muted-foreground)
  - **Created date** (text-xs, text-muted-foreground)
  - **AI columns count** (e.g., "2 AI columns")
  - **Three-dot menu** (DropdownMenu from shadcn): "Edit Scanner" (future -- disabled for now), "Delete Scanner"
  - **Primary action**: "Open" button or the row itself is clickable
- Empty state when no scanners: illustration area with text "No scanners yet. Create your first scanner to start analyzing opportunities." and a "Create Scanner" button

Use `useRouter` from next/navigation to navigate to `/scanners/[id]` when clicking a scanner row.

**2. Create CreateScannerModal component** at `src/components/scanners/create-scanner-modal.tsx`:

Client component. Two-step modal using shadcn Dialog:

**Step 1 -- Type Selection:**
- Dialog title: "Create Scanner"
- Three type cards in a grid (1 col on mobile, 3 cols on desktop):
  - **RFPs / Contracts**: Icon = FileText (lucide), description = "Score government contracts and tenders against your company profile"
  - **Board Meetings & Strategic Plans**: Icon = Landmark (lucide), description = "Analyze board meeting signals for buying intent and relevance"
  - **Buyers / Organizations**: Icon = Building2 (lucide), description = "Score buyer organizations as potential accounts"
- Each card is a button that sets the selected type and moves to step 2

**Step 2 -- Creation Form:**
- Render `ScannerCreationForm` component (Task 2) inside the dialog
- Pass the selected scanner type
- On save: close modal, call parent's onCreated callback with new scanner data, navigate to /scanners/[id]

Props: `{ open: boolean; onOpenChange: (open: boolean) => void; onCreated: (scanner: { _id: string }) => void }`.

**3. Create Scanners page** at `src/app/(dashboard)/scanners/page.tsx`:

Client component ("use client") since it manages scanner list state and modal.

On mount:
- Fetch GET `/api/scanners` to load scanner list
- Display ScannerList with the results
- "+" Create Scanner button in the page header opens CreateScannerModal

Page layout:
- Header: "Scanners" title with "AI-powered analysis across contracts, signals, and organizations" subtitle
- Top right of header: Button "+ Create Scanner" (opens modal)
- Below header: ScannerList component
- Modal: CreateScannerModal

When scanner is created: refresh list and navigate to `/scanners/[newScanner._id]`.
When scanner is deleted: call DELETE API and remove from list.
When scanner row is clicked: navigate to `/scanners/[id]`.

**4. Update sidebar navigation** at `src/components/layout/app-sidebar.tsx`:

- Change "Vibe Scanner" nav item to "Scanners" with the same Sparkles icon
- Update href from "/vibe-scanner" to "/scanners"
- Keep the icon as Sparkles (or change to Radar for a multi-scanner feel -- Claude's discretion)
  </action>
  <verify>
Run `npx next build` to verify no TypeScript errors. Verify page is accessible at /scanners route. Check that sidebar shows "Scanners" link.
  </verify>
  <done>
Scanner list page shows user's scanners with name, type badge, dates, and actions menu. Create Scanner modal has two steps: type selection cards and creation form. Sidebar navigation updated to "Scanners" link. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Scanner creation form with AI-generated search query</name>
  <files>src/components/scanners/scanner-creation-form.tsx</files>
  <action>
**Create ScannerCreationForm component** at `src/components/scanners/scanner-creation-form.tsx`:

Client component ("use client"). Props: `{ type: ScannerType; onSave: (scanner: { _id: string }) => void; onCancel: () => void }`.

**On mount / when type changes:**
- Call POST `/api/scanners/generate-query` with `{ type }` to get AI-generated name, description, and searchQuery
- Show a loading skeleton while generating
- Pre-fill form fields with the AI-generated values

**Form fields:**
- **Scanner Name** (Input): Pre-filled with AI-generated name, editable
- **Description** (Textarea, 2 rows): Pre-filled with AI-generated description, editable
- **Search Query** (Textarea, 6-8 rows, font-mono): Pre-filled with AI-generated OR-joined conditions, editable. Helper text: "AI-generated search conditions based on your company profile. The scanner uses this to evaluate relevance."
- **Type-specific filters** (only show relevant filters based on type):
  - RFPs: Sector select (reuse sector list from contracts page), Region select (reuse region list), Value range (min/max inputs), Deadline date picker (shadcn DatePicker or simple date input)
  - Meetings: Signal type select (PROCUREMENT, STAFFING, STRATEGY, FINANCIAL, PROJECTS, REGULATORY), Org sector select, Date range (from/to)
  - Buyers: Sector select, Region select
  - Each filter is optional -- show as collapsible "Filters" section with a disclosure toggle

**Bottom actions:**
- "Cancel" button (outline, calls onCancel)
- "Create & Open" button (primary, calls create API then onSave):
  1. POST `/api/scanners` with all form data
  2. On success, call onSave with the returned scanner
  3. On error, show error message inline

**State management:**
- Local state for all form fields
- `isGenerating` state for AI query generation loading
- `isCreating` state for scanner creation loading
- Error state for inline error display

**Design notes:**
- Use shadcn Input, Textarea, Select, Button, Label components
- Compact form layout -- this is inside a Dialog, so space is limited
- Loading skeleton during AI generation should replace the name/description/query fields with animated placeholders
  </action>
  <verify>
Run `npx next build` to verify no TypeScript errors. Verify the component renders with all fields for each scanner type. Check that AI query generation endpoint is called on mount.
  </verify>
  <done>
Scanner creation form pre-fills name, description, and search query from AI generation. User can edit all fields and add type-specific filters. "Create & Open" saves the scanner and navigates into it. All three scanner types have appropriate filter options. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `npx next build` succeeds with no errors
2. /scanners page shows scanner list with type badges and actions
3. "+ Create Scanner" opens type selection modal with 3 type cards
4. Selecting a type shows creation form with AI-generated fields
5. "Create & Open" creates scanner and would navigate to /scanners/[id]
6. Sidebar shows "Scanners" link pointing to /scanners
7. Scanner deletion works from list view
</verification>

<success_criteria>
- Scanner list page is accessible at /scanners and shows all user scanners
- Creation flow: type selection -> AI query generation -> editable form -> save
- All three scanner types have appropriate type cards and filter options
- Sidebar navigation updated from "Vibe Scanner" to "Scanners"
- VIBE-01 (create scanner), VIBE-02 (generate scoring query), VIBE-03 (view/edit query) partially satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-vibe-scanner/05-02-SUMMARY.md`
</output>
