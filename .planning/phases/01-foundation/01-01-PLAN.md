---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - src/app/globals.css
  - src/app/layout.tsx
  - src/app/(auth)/sign-in/[[...sign-in]]/page.tsx
  - src/app/(auth)/sign-up/[[...sign-up]]/page.tsx
  - src/app/(auth)/layout.tsx
  - src/proxy.ts
  - src/lib/utils.ts
  - src/lib/env.ts
  - components.json
  - .env.local
  - .env.example
autonomous: false
user_setup:
  - service: clerk
    why: "Authentication (signup, signin, session management)"
    env_vars:
      - name: NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY
        source: "Clerk Dashboard (clerk.com) -> Your Application -> API Keys"
      - name: CLERK_SECRET_KEY
        source: "Clerk Dashboard (clerk.com) -> Your Application -> API Keys"
    account_setup:
      - "Create a Clerk account at clerk.com if you don't have one"
      - "Create a new Clerk application named 'TendHunt'"
      - "Enable Email/Password and Google social login in User & Authentication -> Email, Phone, Username"
    dashboard_config:
      - task: "Copy Publishable Key and Secret Key"
        location: "Clerk Dashboard -> Your Application -> API Keys"

must_haves:
  truths:
    - "Next.js 16 app builds and starts without errors"
    - "Tailwind CSS v4 styles render correctly with OKLCH color tokens"
    - "shadcn/ui components are installed and importable"
    - "Visiting /sign-in shows Clerk SignIn component"
    - "Visiting /sign-up shows Clerk SignUp component"
    - "Unauthenticated users are redirected from protected routes to /sign-in"
    - "Environment variables are validated at startup with Zod"
  artifacts:
    - path: "package.json"
      provides: "Project manifest with all dependencies"
      contains: "next"
    - path: "src/proxy.ts"
      provides: "Clerk auth proxy (replaces middleware.ts in Next.js 16)"
      contains: "clerkMiddleware"
    - path: "src/app/layout.tsx"
      provides: "Root layout with ClerkProvider"
      contains: "ClerkProvider"
    - path: "src/app/(auth)/sign-in/[[...sign-in]]/page.tsx"
      provides: "Clerk sign-in page"
      contains: "SignIn"
    - path: "src/app/(auth)/sign-up/[[...sign-up]]/page.tsx"
      provides: "Clerk sign-up page"
      contains: "SignUp"
    - path: "src/lib/env.ts"
      provides: "Zod-validated environment variables"
      contains: "MONGODB_URI"
    - path: "src/app/globals.css"
      provides: "Tailwind v4 CSS-first config with shadcn/ui OKLCH tokens"
      contains: "@import"
    - path: "components.json"
      provides: "shadcn/ui configuration"
      contains: "shadcn"
  key_links:
    - from: "src/proxy.ts"
      to: "src/app/(auth)/sign-in/[[...sign-in]]/page.tsx"
      via: "createRouteMatcher marks /sign-in as public, auth.protect() blocks protected routes"
      pattern: "isPublicRoute|createRouteMatcher"
    - from: "src/app/layout.tsx"
      to: "@clerk/nextjs"
      via: "ClerkProvider wraps the entire app"
      pattern: "ClerkProvider"
---

<objective>
Scaffold the Next.js 16 project with Tailwind CSS v4, shadcn/ui components, and Clerk authentication -- the foundational toolchain every subsequent phase builds on.

Purpose: Every feature in TendHunt (dashboard, contract feed, Vibe Scanner, credit system) needs a running Next.js app with authentication and styled components. This plan creates that foundation.
Output: A buildable Next.js 16 app with Clerk sign-in/sign-up pages, Tailwind v4 styling, shadcn/ui component library, and route protection via proxy.ts.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Next.js 16 project with Tailwind v4, shadcn/ui, and core dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    src/app/globals.css
    src/lib/utils.ts
    components.json
    .env.local
    .env.example
  </files>
  <action>
1. Run `npx create-next-app@latest . --typescript --tailwind --app --src-dir --import-alias "@/*"` to scaffold into the current directory (project root already exists with .planning/ and .claude/ dirs). If prompted about overwriting, accept defaults. Use `--yes` flag or equivalent to skip prompts.

2. Install core dependencies:
   ```
   npm install mongoose @clerk/nextjs zod zustand
   ```

3. Initialize shadcn/ui:
   ```
   npx shadcn@latest init --defaults
   ```
   This creates `components.json` and sets up the `src/components/ui/` directory.

4. Add required shadcn/ui components for the app shell (Plan 02 needs these):
   ```
   npx shadcn@latest add button card badge sidebar sheet avatar dropdown-menu separator input tooltip
   ```

5. Configure `src/app/globals.css` with Tailwind v4 CSS-first config using OKLCH color tokens from shadcn/ui. Use the exact pattern from RESEARCH.md including `@import "tailwindcss"`, `@import "tw-animate-css"`, `@custom-variant dark`, and the full `:root` and `@theme inline` blocks with sidebar CSS variables.

6. Verify `next.config.ts` is minimal -- Mongoose is auto-externalized in Next.js 16, Turbopack is default. No special config needed.

7. Create `.env.local` with placeholder values:
   ```
   MONGODB_URI=mongodb+srv://placeholder:placeholder@cluster.mongodb.net/tendhunt?retryWrites=true&w=majority
   NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_placeholder
   CLERK_SECRET_KEY=sk_test_placeholder
   CLERK_WEBHOOK_SIGNING_SECRET=whsec_placeholder
   NEXT_PUBLIC_CLERK_SIGN_IN_URL=/sign-in
   NEXT_PUBLIC_CLERK_SIGN_UP_URL=/sign-up
   NEXT_PUBLIC_CLERK_AFTER_SIGN_IN_URL=/dashboard
   NEXT_PUBLIC_CLERK_AFTER_SIGN_UP_URL=/dashboard
   ```

8. Create `.env.example` with same keys but no values (for documentation).

9. Create `src/lib/env.ts` with Zod schema validation for all environment variables. Validate MONGODB_URI (string, starts with mongodb), CLERK_SECRET_KEY (string, starts with sk_), NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY (string, starts with pk_), CLERK_WEBHOOK_SIGNING_SECRET (string), and the 4 Clerk URL variables. Export a typed `env` object. Only validate server-side vars on the server (check `typeof window`).

IMPORTANT: Use `proxy.ts` NOT `middleware.ts` -- Next.js 16 renamed this file. Clerk SDK supports both.
IMPORTANT: Tailwind v4 uses CSS-first config -- do NOT create `tailwind.config.js` or `tailwind.config.ts`. All config goes in `globals.css`.
IMPORTANT: Use `tw-animate-css` (NOT `tailwindcss-animate`) -- the old package is deprecated.
  </action>
  <verify>
    Run `npm run build` and confirm it completes without errors. Verify `src/components/ui/button.tsx` exists (shadcn/ui installed). Verify `components.json` exists. Verify `.env.local` and `.env.example` exist.
  </verify>
  <done>
    Next.js 16 project builds successfully. shadcn/ui components (button, card, badge, sidebar, sheet, avatar, dropdown-menu, separator, input, tooltip) are installed in src/components/ui/. Tailwind v4 CSS-first config is in globals.css with OKLCH tokens. Environment variable validation module exists at src/lib/env.ts.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Clerk authentication with proxy.ts, auth pages, and root layout</name>
  <files>
    src/proxy.ts
    src/app/layout.tsx
    src/app/(auth)/sign-in/[[...sign-in]]/page.tsx
    src/app/(auth)/sign-up/[[...sign-up]]/page.tsx
    src/app/(auth)/layout.tsx
  </files>
  <action>
1. Create `src/proxy.ts` (NOT middleware.ts) with Clerk's `clerkMiddleware` from `@clerk/nextjs/server`. Use `createRouteMatcher` to mark these routes as public:
   - `/` (landing page)
   - `/sign-in(.*)`
   - `/sign-up(.*)`
   - `/api/webhooks(.*)`
   For non-public routes, call `await auth.protect()`. Export `config` with the standard Next.js matcher pattern that excludes static files and _next paths:
   ```
   matcher: [
     '/((?!_next|[^?]*\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)',
     '/(api|trpc)(.*)',
   ]
   ```

2. Update `src/app/layout.tsx`:
   - Wrap the entire app with `<ClerkProvider>` from `@clerk/nextjs`
   - Set metadata: title "TendHunt - UK Procurement Intelligence", description "AI-powered contract alerts and buyer intelligence for UK government procurement"
   - Body classes: `min-h-screen bg-background font-sans antialiased`
   - Import `./globals.css`

3. Create `src/app/(auth)/layout.tsx`:
   - A centered layout for auth pages (flexbox centering both horizontally and vertically, min-h-screen)
   - Simple layout with no sidebar/header -- just the auth form centered

4. Create `src/app/(auth)/sign-in/[[...sign-in]]/page.tsx`:
   - Import and render `<SignIn />` from `@clerk/nextjs`
   - This is a catch-all route page -- the file path handles Clerk's multi-step sign-in flow

5. Create `src/app/(auth)/sign-up/[[...sign-up]]/page.tsx`:
   - Import and render `<SignUp />` from `@clerk/nextjs`
   - Same catch-all pattern for multi-step sign-up

6. Delete `src/middleware.ts` if create-next-app generated one (it should not in Next.js 16, but check).

IMPORTANT: The proxy.ts file must be at `src/proxy.ts` (inside src/ since we used --src-dir). Next.js 16 looks for proxy.ts at the project root OR in src/.
IMPORTANT: All params and searchParams in Next.js 16 are async -- must be awaited. The auth pages don't use them directly (Clerk handles routing), but keep this in mind.
  </action>
  <verify>
    Run `npm run build` and confirm no errors. Verify that `src/proxy.ts` exists and contains `clerkMiddleware`. Verify auth page files exist at the correct catch-all route paths.
  </verify>
  <done>
    Clerk authentication is configured: proxy.ts protects all routes except public ones, ClerkProvider wraps the app in root layout, sign-in and sign-up pages render Clerk components at /sign-in and /sign-up. Unauthenticated users visiting protected routes are redirected to /sign-in.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify Clerk auth flow works end-to-end</name>
  <what-built>Next.js 16 project with Clerk authentication, Tailwind v4 styling, and shadcn/ui component library. Sign-in and sign-up pages are configured at /sign-in and /sign-up. Protected routes redirect to sign-in.</what-built>
  <how-to-verify>
    Before testing, you MUST configure real Clerk credentials:
    1. Replace placeholder values in `.env.local` with real Clerk API keys from your Clerk Dashboard
    2. Start the dev server: `npm run dev`
    3. Visit http://localhost:3000/sign-up -- you should see the Clerk sign-up form
    4. Visit http://localhost:3000/sign-in -- you should see the Clerk sign-in form
    5. Visit http://localhost:3000/dashboard -- you should be redirected to /sign-in (protected route)
    6. Sign up with a test account -- after sign-up you should be redirected to /dashboard (which will show the default Next.js page or 404 for now -- that is expected, the dashboard shell comes in Plan 02)
    7. Refresh the page -- you should still be signed in (session persistence via Clerk)
    8. Verify Tailwind styles are working -- the sign-in/sign-up forms should be centered on the page
  </how-to-verify>
  <resume-signal>Type "approved" if auth flow works, or describe any issues you see.</resume-signal>
</task>

</tasks>

<verification>
Phase 1 Plan 01 verification checklist:
1. `npm run build` succeeds without errors
2. `src/proxy.ts` exists with clerkMiddleware (NOT middleware.ts)
3. `src/app/(auth)/sign-in/[[...sign-in]]/page.tsx` exists with SignIn component
4. `src/app/(auth)/sign-up/[[...sign-up]]/page.tsx` exists with SignUp component
5. `src/app/layout.tsx` wraps children in ClerkProvider
6. `src/app/globals.css` uses Tailwind v4 CSS-first config (no tailwind.config.js)
7. `components.json` exists (shadcn/ui configured)
8. `src/components/ui/button.tsx` exists (shadcn/ui components installed)
9. `.env.local` and `.env.example` have all required keys
10. `src/lib/env.ts` validates environment variables with Zod
</verification>

<success_criteria>
- Next.js 16 project builds successfully with `npm run build`
- Clerk sign-in and sign-up pages render at /sign-in and /sign-up
- Protected routes redirect unauthenticated users to /sign-in
- Tailwind v4 CSS-first config renders OKLCH color tokens correctly
- shadcn/ui components (button, card, badge, sidebar, etc.) are installed and importable
- Environment variables are validated with Zod on startup
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
